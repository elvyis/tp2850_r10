C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TP2825B
OBJECT MODULE PLACED IN .\obj\TP2825B.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE src\TP2825B.c LARGE OPTIMIZE(9,SIZE) BROWSE DEBUG OBJECTEXTEND PRINT(.\l
                    -st\TP2825B.lst) TABS(2) OBJECT(.\obj\TP2825B.obj)

line level    source

   1          // *****************************************************
   2          // Company : Techpoint Inc
   3          // $Date: 2014-03-10 
   4          // $Log:  $
   5          // ******************************************************
   6          
   7          #include "inc\Config.h"
   8          #include "stdlib.h"
   9          #include "inc\typedefs.h"
  10          #include "inc\I2C.h"
  11          #include "inc\main.h"
  12          #include "inc\printf.h"
  13          #include "inc\TP2825.h"
  14          
  15          extern xdata BYTE ManVidRes;
  16          extern xdata BYTE ManVidStd;
  17          extern xdata BYTE ManSelCh;
  18          extern xdata BYTE TVII2CAddress;
  19          
  20          xdata BYTE  PTZ_buf[16];
  21          xdata DWORD PTZ_pelco;
  22          xdata BYTE crc;
  23          
  24          #define CH_PER_CHIP 0x01
  25          #define MAX_COUNT   0xff
  26          
  27          extern bit DetAutoRes;
  28          extern bit DetAutoStd;
  29          extern bit half_scaler;
  30          extern bit en_tvi960p_H1400;
  31          extern bit BT1120_out;
  32          extern bit en_960P;
  33          void delay(BYTE);
  34          xdata BYTE  state[CH_PER_CHIP];
  35          xdata BYTE  count[CH_PER_CHIP];
  36          xdata BYTE  mode[CH_PER_CHIP];
  37          xdata BYTE  std[CH_PER_CHIP];
  38          IDATA BYTE  egain[CH_PER_CHIP][4];
  39          IDATA BYTE  revision;
  40          IDATA BYTE  chip;
  41          IDATA BYTE  UTC_data;
  42          xdata BYTE  res;
  43          bit sywd;
  44          
  45          extern void CreateMDIN340VideoInstance(void);
  46          
  47          enum
  48          {
  49            TP2850 =0x50,
  50            TP2825B=0x25,
  51            TP2860 =0x60,
  52          };      
  53          //////////////////////////////////////////////////////
  54          ////
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 2   

  55          /////////////////////////////////////////////////////
  56          CODE BYTE TP2860_DataSet[] = {
  57          0x40, 0x00,
  58              0x42, 0x00,
  59              0x4e, 0x1d,
  60              0xf6, 0x00, //
  61              0xf7, 0x44,
  62              0xfa, 0x88,
  63              0x1b, 0x01, //
  64              0xfd, 0x80,
  65          0x40, 0x08,
  66          0x13, 0xef,
  67          0x14, 0x41,
  68          0x15, 0x02,
  69          0x40, 0x00,
  70          0xff, 0xff
  71          };
  72          
  73          //////////////////////////////////////////////////////
  74          ////
  75          /////////////////////////////////////////////////////
  76          CODE BYTE TP2825B_DataSet[] = {
  77          
  78              0x40, 0x00,
  79              0x35, 0x25,
  80              0x4c, 0x43, //BT601 enable
  81              0x4e, 0x1d,
  82              0xf5, 0x10,
  83              0xfd, 0x80,
  84              0xf6, 0x00, //
  85              0xf7, 0x44,
  86              0xfa, 0x03,
  87              0x1b, 0x01, //
  88              0xff, 0xff
  89            };
  90          
  91          //////////////////////////////////////////////////////
  92          ////
  93          /////////////////////////////////////////////////////
  94          #define MAX_FORMAT 
  95          CODE BYTE TP2825B_FORMAT_DataSet[MAX_FORMAT][32] = {
  96          //addr
  97            {0x02,0x0c,0x0d, 0x15,0x16,0x17,0x18,0x19,0x1a,0x1c,0x1d, 0x20,0x21,0x22,0x23, 0x25,0x26,0x27,0x28, 0x2b,
             -0x2c,0x2d,0x2e, 0x30,0x31,0x32,0x33, 0x35,0x36,0x00,0x39,0x3a},
  98          //1NTSC 960H
  99            {0xcf,0x13,0x50, 0x13,0x60,0xbc,0x12,0xf0,0x07,0x09,0x38, 0x40,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x70,
             -0x2a,0x68,0x57, 0x62,0xbb,0x96,0xc0, 0x65,0xdc,0x00,0x04,0x32},
 100            //{0xcf,0x13,0x50, 0x03,0xd6,0xa0,0x12,0xf0,0x05,0x06,0xb4, 0x40,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x7
             -0,0x2a,0x4b,0x57, 0x62,0xbb,0x96,0xcb, 0x65,0xdc,0x00,0x04,0x32},
 101          //2PAL 960H
 102            {0xcf,0x13,0x51, 0x13,0x76,0xbc,0x17,0x20,0x17,0x09,0x48, 0x48,0x84,0x37,0x3f, 0xff,0x05,0x2d,0x00, 0x70,
             -0x2a,0x64,0x56, 0x7a,0x4a,0x4d,0xf0, 0x65,0xdc,0x00,0x04,0x32}, 
 103            //{0xcf,0x13,0x51, 0x03,0xf0,0xa0,0x17,0x20,0x15,0x06,0xc0, 0x48,0x84,0x37,0x3f, 0xff,0x05,0x2d,0x00, 0x7
             -0,0x2a,0x4b,0x56, 0x7a,0x4a,0x4d,0xfb, 0x65,0xdc,0x00,0x04,0x32}, 
 104          //3TVI 720P30V2
 105            {0xca,0x13,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x06,0x72, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x25,0xdc,0x00,0x18,0x32},
 106          //4TVI 720P25V2 
 107            {0xca,0x13,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x07,0xbc, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x25,0xdc,0x00,0x18,0x32},   
 108          //5TVI 1080P30
 109            {0xc8,0x03,0x50, 0x03,0xd2,0x80,0x29,0x38,0x47,0x08,0x98, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 3   

             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 110          //6TVI 1080P25
 111            {0xc8,0x03,0x50, 0x03,0xd2,0x80,0x29,0x38,0x47,0x0a,0x50, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},   
 112          //7HDA 720P30
 113            {0xce,0x13,0x70, 0x13,0x16,0x00,0x19,0xd0,0x25,0x06,0x72, 0x40,0x46,0x36,0x3c, 0xfe,0x01,0x2d,0x00, 0x60,
             -0x3a,0x5a,0x40, 0x9d,0xca,0x01,0xd0, 0x25,0xdc,0x00,0x18,0x32},   
 114          //8HDA 720P25
 115            {0xce,0x13,0x71, 0x13,0x16,0x00,0x19,0xd0,0x25,0x07,0xbc, 0x40,0x46,0x36,0x3c, 0xfe,0x01,0x2d,0x00, 0x60,
             -0x3a,0x5a,0x40, 0x9e,0x20,0x01,0x90, 0x25,0xdc,0x00,0x18,0x32},       
 116          //9HDA 1080P30
 117            {0xcc,0x03,0x72, 0x01,0xf0,0x80,0x29,0x38,0x47,0x08,0x98, 0x38,0x46,0x36,0x3c, 0xfe,0x0d,0x2d,0x00, 0x60,
             -0x3a,0x54,0x40, 0xa5,0x95,0xe0,0x60, 0x05,0xdc,0x00,0x1c,0x32},
 118          //10HDA 1080P25
 119            {0xcc,0x03,0x73, 0x01,0xf0,0x80,0x29,0x38,0x47,0x0a,0x50, 0x3c,0x46,0x36,0x3c, 0xfe,0x0d,0x2d,0x00, 0x60,
             -0x3a,0x54,0x40, 0xa5,0x86,0xfb,0x60, 0x05,0xdc,0x00,0x1c,0x32},
 120          //11TVI 720P60
 121            {0xca,0x03,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x06,0x72, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 122          //12TVI 720P50  
 123            {0xca,0x03,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x07,0xbc, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},     
 124          //13TVI QHD30
 125            {0xc8,0x03,0x50, 0x23,0x1b,0x04,0x38,0xa0,0x5a,0x0c,0xe4, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x58,0x70, 0x74,0x58,0x9f,0x60, 0x15,0xdc,0x40,0x40,0x12},
 126          //14TVI QHD25 
 127            {0xc8,0x03,0x50, 0x23,0x1b,0x04,0x38,0xa0,0x5a,0x0f,0x78, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x58,0x70, 0x74,0x58,0x9f,0x60, 0x15,0xdc,0x40,0x40,0x12},   
 128          //15TVI 720P30V1
 129            {0xca,0x03,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x0c,0xe4, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 130          //16TVI 720P25V1  
 131            {0xca,0x03,0x50, 0x13,0x16,0x00,0x19,0xd0,0x25,0x0f,0x78, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 132          //17TVI 8MP15
 133            {0xc8,0x03,0x50, 0x13,0xbd,0x04,0x50,0x70,0x8f,0x11,0x30, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x58,0x70, 0x74,0x59,0xbd,0x60, 0x18,0xca,0x40,0x40,0x12},
 134          //18TVI 8MP12 
 135            {0xc8,0x03,0x50, 0x13,0xbd,0x04,0x50,0x70,0x8f,0x14,0xa0, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x58,0x70, 0x74,0x59,0xbd,0x60, 0x18,0xca,0x40,0x40,0x12},
 136          //19TVI 5MP20 
 137            {0xc8,0x03,0x50, 0x23,0x36,0x24,0x1a,0x98,0x7a,0x0e,0xa4, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x54,0x70, 0x74,0xa7,0x18,0x50, 0x17,0xbc,0x40,0x40,0x12},
 138          //20TVI 1080P60 
 139            {0xc8,0x03,0x50, 0x03,0xde,0x80,0x28,0x38,0x47,0x08,0x96, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x40,0x70, 0x74,0x9b,0xa5,0xe0, 0x05,0xbc,0x40,0x40,0x12},
 140          //21TVI 5M12.5
 141            {0xc8,0x03,0x50, 0x13,0x1f,0x20,0x34,0x98,0x7a,0x0b,0x9a, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x17,0xd0,0x00,0x1c,0x32},
 142          //22HDA 5M12.5  
 143            {0xc8,0x03,0x50, 0x13,0x10,0x20,0x1a,0x98,0x7a,0x0b,0xb8, 0x38,0x46,0x36,0x3c, 0xfe,0x01,0x2d,0x00, 0x60,
             -0x0a,0x44,0x40, 0x29,0x68,0x72,0xb0, 0x17,0xbc,0x00,0x1c,0x32},   
 144          //23TVI 720P30HDR
 145            {0xca,0x13,0x50, 0x03,0xb2,0x00,0x60,0xd0,0x25,0x05,0xdc, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x28,0x70, 0x48,0xba,0x2e,0x90, 0x33,0x39,0x00,0x18,0x32},
 146          //24TVI WXGA
 147          //  {0xca,0x13,0x50, 0x03,0xf4,0x00,0xa0,0x20,0x35,0x06,0x90, 0x60,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x6
             -0,0x0a,0x32,0x70, 0x48,0xbb,0x2e,0x90, 0x13,0xc0,0x00,0x18,0x32},
 148            {0xca,0x13,0x50, 0x03,0xee,0x00,0x90,0xd0,0x25,0x06,0x3c, 0x60,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x32,0x70, 0x4c,0x30,0xc3,0x00, 0x13,0xe8,0x00,0x18,0x32},       
 149          //25TVI 1080P27.5
 150            {0xc8,0x03,0x50, 0x13,0x98,0x80,0x29,0x38,0x47,0x09,0x60, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 4   

             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 151          //26TVI 1080P24
 152            {0xc8,0x03,0x50, 0x13,0x40,0x80,0x29,0x38,0x47,0x0a,0xbe, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x05,0xdc,0x00,0x1c,0x32},
 153          //27TVI 1080P15
 154            {0xc8,0x03,0x50, 0x03,0xd2,0x80,0x29,0x38,0x47,0x08,0x98, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x25,0xdc,0x00,0x18,0x32},   
 155          //28TVI 1280x320P60
 156            {0xca,0x03,0x50, 0x13,0x10,0x00,0x32,0x40,0x15,0x06,0x72, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xba,0x2e,0x90, 0x31,0x77,0x00,0x18,0x32},   
 157          //29HDA 720P30 for TP2860
 158            {0xca,0x13,0x70, 0x13,0x16,0x00,0x19,0xd0,0x25,0x86,0x70, 0x38,0x46,0x36,0x3c, 0xfe,0x01,0xad,0x00, 0x60,
             -0x3a,0x48,0x40, 0x4e,0xe5,0x00,0xf0, 0x25,0xdc,0x00,0x08,0x32},   
 159          //30HDA 720P25 for TP2860
 160            {0xca,0x13,0x70, 0x13,0x16,0x00,0x19,0xd0,0x25,0x87,0xba, 0x38,0x46,0x36,0x3c, 0xfe,0x01,0xad,0x00, 0x60,
             -0x3a,0x48,0x40, 0x4f,0x10,0x08,0x40, 0x25,0xdc,0x00,0x08,0x32},       
 161          //31HDA 1080P30 for TP2860
 162            {0xc8,0x03,0x70, 0x01,0xf0,0x80,0x29,0x38,0x47,0x88,0x96, 0x38,0x46,0x36,0x3c, 0xfe,0x0d,0xad,0x00, 0x60,
             -0x3a,0x48,0x40, 0x52,0xca,0xf0,0x20, 0x25,0xdc,0x00,0x0c,0x32},
 163          //32HDA 1080P25 for TP2860
 164            {0xc8,0x03,0x70, 0x01,0xf0,0x80,0x29,0x38,0x47,0x8a,0x4e, 0x3c,0x46,0x36,0x3c, 0xfe,0x0d,0xad,0x00, 0x60,
             -0x3a,0x48,0x40, 0x52,0xc3,0x7d,0xa0, 0x25,0xdc,0x00,0x0c,0x32},   
 165          //33HDA 960P25 for TP2860
 166            {0xc8,0x03,0x70, 0x03,0xe6,0x00,0x89,0xc0,0x35,0x8a,0x8a, 0x40,0x46,0x36,0x3c, 0xfe,0x05,0xad,0x00, 0x60,
             -0x3a,0x50,0x58, 0x52,0xd2,0x1c,0x00, 0x34,0x4c,0x00,0x0c,0x32},   
 167          //34 NTSC 720H
 168            //{0xcf,0x13,0x50, 0x13,0x60,0xbc,0x12,0xf0,0x07,0x09,0x38, 0x40,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x7
             -0,0x2a,0x68,0x57, 0x62,0xbb,0x96,0xc0, 0x25,0xdc,0x00,0x04,0x32},
 169            {0xcf,0x13,0x50, 0x03,0xd6,0xa0,0x12,0xf0,0x05,0x06,0xb4, 0x40,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x70,
             -0x2a,0x4b,0x57, 0x62,0xbb,0x96,0xcb, 0x65,0xdc,0x00,0x04,0x32},
 170          //35 PAL 720H
 171            //{0xcf,0x13,0x51, 0x13,0x76,0xbc,0x17,0x20,0x17,0x09,0x48, 0x48,0x84,0x37,0x3f, 0xff,0x05,0x2d,0x00, 0x7
             -0,0x2a,0x64,0x56, 0x7a,0x4a,0x4d,0xf0, 0x25,0xdc,0x00,0x04,0x32}, 
 172            {0xcf,0x13,0x51, 0x03,0xf0,0xa0,0x17,0x20,0x15,0x06,0xc0, 0x48,0x84,0x37,0x3f, 0xff,0x05,0x2d,0x00, 0x70,
             -0x2a,0x4b,0x56, 0x7a,0x4a,0x4d,0xfb, 0x65,0xdc,0x00,0x04,0x32}, 
 173          //36 TVI 960P30
 174            {0xc8,0x03,0x50, 0x13,0x16,0x00,0xa0,0xc0,0x35,0x06,0x72, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x43,0x3b,0x79,0x90, 0x14,0x65,0x00,0x18,0x32},   //reg30-33 = 0x43_3B_79_90(29.2500M)
 175          //37 TVI 960P25
 176            {0xc8,0x03,0x50, 0x13,0x16,0x00,0xa0,0xc0,0x35,0x07,0xbc, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xba,0x2e,0x90, 0x14,0x65,0x00,0x18,0x32},   //reg30-33 = 0x43_3B_79_90(29.2500M)    
 177          //38 AHD 960P30 54M 1800x1000
 178            {0xce,0x03,0x76, 0x13,0x8f,0x00,0x23,0xd0,0x25,0x07,0x08, 0x60,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x3a,0x70,0x50, 0x7f,0x49,0xf4,0x90, 0x13,0xe8,0x00,0x88,0x32}, 
 179          //39 AHD 960P30 54M 1800x1000
 180            {0xca,0x13,0x50, 0x13,0x60,0x00,0x90,0xd0,0x25,0x87,0x06, 0x60,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x3a,0x32,0x70, 0x40,0x62,0x4d,0xd3, 0x33,0xe8,0x00,0x18,0x32},   
 181          //40 TVI 960P30 54M
 182            {0xc8,0x03,0x50, 0x13,0x18,0x00,0xa0,0xc0,0x35,0x06,0x74, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x45,0x55,0x55,0x53, 0x14,0x65,0x00,0x18,0x32},   //reg30-33 = 0x43_3B_79_90(29.2500M)
 183          //41 TVI 960P25 54M
 184            {0xc8,0x03,0x50, 0x13,0x16,0x00,0xa0,0xc0,0x35,0x07,0x80, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x4b,0x00,0x00,0x00, 0x14,0x65,0x00,0x18,0x32},   //reg30-33 = 0x43_3B_79_90(29.2500M)    
 185          //42 TVI 720P25HDR
 186            {0xca,0x13,0x50, 0x03,0xb2,0x00,0x60,0xd0,0x25,0x07,0x08, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x28,0x70, 0x48,0xba,0x2e,0x90, 0x33,0x39,0x00,0x18,0x32},
 187          //43 AHD 960P30 1650x1125
 188            {0xcc,0x03,0x70, 0x12,0x12,0x00,0xa0,0xc0,0x35,0x06,0x72, 0x48,0x84,0x36,0x3c, 0xff,0x0d,0x2d,0x00, 0x60,
             -0x0a,0x58,0x70, 0x9d,0xca,0x01,0xe0, 0x14,0x65,0x00,0x88,0x32},   //~17M
 189          //44 AHD 960P30 1400x1125
 190            {0xc8,0x03,0x76, 0x03,0x5f,0x00,0x9c,0xc0,0x35,0x85,0x78, 0x14,0x84,0x36,0x3c, 0xff,0x0d,0x2d,0x00, 0x60,
             -0x0a,0x1e,0x50, 0x29,0x01,0x76,0x80, 0x14,0x65,0x00,0x88,0x32},   //~15M  
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 5   

 191          //45 TVI 1080P50  
 192            {0xc8,0x03,0x50, 0x03,0xde,0x80,0x28,0x38,0x47,0x0a,0x48, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x0a,0x40,0x70, 0x74,0x9b,0xa5,0xe0, 0x05,0xbc,0x40,0x40,0x12},   
 193          //46 TVI 960P30 1400X1125 
 194            {0xc8,0x03,0x50, 0x03,0x60,0x00,0xa0,0xc0,0x35,0x05,0x78, 0x18,0x84,0x36,0x3c, 0xff,0x07,0x2d,0x00, 0x60,
             -0x1a,0x1a,0x70, 0x48,0xba,0x2e,0x90, 0x14,0x65,0x40,0x88,0x12},   
 195          //47 TVI 1080P25_X3C
 196            {0xc8,0x03,0x50, 0x03,0xd2,0x80,0x29,0x38,0x47,0x09,0xab, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x0a,0x30,0x70, 0x48,0xbb,0x2e,0x90, 0x14,0xb5,0x00,0x1c,0x32}, 
 197          //48 TVI 1280x720P864M
 198            {0xca,0x13,0x50, 0x03,0xec,0x00,0xae,0xd0,0x25,0x06,0x40, 0x30,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x2a,0x30,0x70, 0x48,0xba,0x2e,0x90, 0x13,0x84,0x00,0x18,0x32}, 
 199          //49 TVI QHD275
 200            {0xc8,0x03,0x50, 0x33,0x48,0x00,0x36,0xa0,0x5a,0x0e,0x0e, 0x50,0x84,0x36,0x3c, 0xff,0x05,0xad,0x00, 0x60,
             -0x2a,0x58,0x70, 0x74,0x58,0x9f,0x60, 0x15,0xdc,0x40,0x48,0x12},   
 201          //50 TVI 480P20
 202            {0xce,0x03,0x76, 0x13,0xd8,0x00,0x14,0x00,0x28,0x09,0xc4, 0x50,0x84,0x36,0x3c, 0xff,0x05,0x2d,0x00, 0x60,
             -0x2a,0x6c,0x70, 0x43,0xe4,0x25,0xb0, 0x52,0x1c,0x40,0x48,0x12},     
 203          };
 204          static void TP2825B_SYSCLK_54M(void)
 205          {
 206   1        if(TP2860 == chip)
 207   1        {
 208   2          tp28xx_byte_write(0x40, 0x08);
 209   2          tp28xx_byte_write(0x12, 0x4e);
 210   2          tp28xx_byte_write(0x13, 0xef);            
 211   2          tp28xx_byte_write(0x14, 0x41);
 212   2          tp28xx_byte_write(0x15, 0x12);    
 213   2          tp28xx_byte_write(0x40, 0x00);    
 214   2          
 215   2        }
 216   1        else
 217   1        {
 218   2          tp28xx_byte_write(0x40, 0x08);
 219   2          tp28xx_byte_write(0x11, 0x4e);
 220   2          tp28xx_byte_write(0x13, 0x04);
 221   2          tp28xx_byte_write(0x14, 0x04);
 222   2          tp28xx_byte_write(0x40, 0x00);
 223   2        }
 224   1      }
 225          static void TP2860_SYSCLK_111375K(void)
 226          {
 227   1        if(TP2860 == chip)
 228   1        {
 229   2          
 230   2          tp28xx_byte_write(0x40, 0x08);
 231   2          tp28xx_byte_write(0x12, 0x5f);
 232   2          tp28xx_byte_write(0x13, 0x0f);    
 233   2          tp28xx_byte_write(0x14, 0x41);
 234   2          tp28xx_byte_write(0x15, 0x02);    
 235   2          tp28xx_byte_write(0x40, 0x00);    
 236   2        }
 237   1      } 
 238          static void TP2825B_SYSCLK_945(void)
 239          {
 240   1        if(TP2860 == chip)
 241   1        {
 242   2          tp28xx_byte_write(0x40, 0x08);
 243   2          tp28xx_byte_write(0x12, 0x5a);
 244   2          tp28xx_byte_write(0x13, 0xef);            
 245   2          tp28xx_byte_write(0x14, 0x41);
 246   2          tp28xx_byte_write(0x15, 0x12);    
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 6   

 247   2          tp28xx_byte_write(0x40, 0x00);        
 248   2        }
 249   1        else
 250   1        {
 251   2          tp28xx_byte_write(0x40, 0x08);
 252   2          tp28xx_byte_write(0x11, 0x5A);
 253   2          tp28xx_byte_write(0x13, 0x24);
 254   2          tp28xx_byte_write(0x14, 0x04);
 255   2          tp28xx_byte_write(0x40, 0x00);
 256   2        }
 257   1      }
 258          
 259          static void TP2825B_SYSCLK_864(void)
 260          {
 261   1        if(TP2860 == chip)
 262   1        {
 263   2          tp28xx_byte_write(0x40, 0x08);
 264   2          tp28xx_byte_write(0x12, 0x7E);
 265   2          tp28xx_byte_write(0x13, 0x67);            
 266   2          tp28xx_byte_write(0x14, 0x41);
 267   2          tp28xx_byte_write(0x15, 0x02);    
 268   2          tp28xx_byte_write(0x40, 0x00);        
 269   2        }
 270   1        else
 271   1        {
 272   2          tp28xx_byte_write(0x40, 0x08);
 273   2          tp28xx_byte_write(0x11, 0x5A);
 274   2          tp28xx_byte_write(0x13, 0x24);
 275   2          tp28xx_byte_write(0x14, 0x04);
 276   2          tp28xx_byte_write(0x40, 0x00);
 277   2        }
 278   1      }
 279          static void TP2860_SYSCLK_A720P(void)
 280          {
 281   1          tp28xx_byte_write(0x40, 0x08);
 282   1          tp28xx_byte_write(0x14, 0x50);
 283   1          tp28xx_byte_write(0x15, 0x09);    
 284   1          tp28xx_byte_write(0x40, 0x00);  
 285   1          tp28xx_byte_write(0xf6, 0x04);  
 286   1          tp28xx_byte_write(0xfa, 0x03);  
 287   1      }
 288          static void TP2860_SYSCLK_A1080P(void)
 289          {
 290   1          tp28xx_byte_write(0x40, 0x08);
 291   1          tp28xx_byte_write(0x14, 0x40);
 292   1          tp28xx_byte_write(0x15, 0x05);    
 293   1          tp28xx_byte_write(0x40, 0x00);  
 294   1          tp28xx_byte_write(0xf6, 0x04);  
 295   1          tp28xx_byte_write(0xfa, 0x03);    
 296   1      }
 297          
 298          static void TP2825B_SYSCLK_V2(void)
 299          {
 300   1        if(TP2860 == chip)
 301   1        {
 302   2          tp28xx_byte_write(0x40, 0x08);
 303   2          tp28xx_byte_write(0x12, 0x54);
 304   2          tp28xx_byte_write(0x13, 0xef);          
 305   2          tp28xx_byte_write(0x14, 0x41);
 306   2          tp28xx_byte_write(0x15, 0x12);    
 307   2          tp28xx_byte_write(0x40, 0x00);
 308   2          tp28xx_byte_write(0xfa, 0x00);      
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 7   

 309   2        }
 310   1        else
 311   1        { 
 312   2          tp28xx_byte_write(0x40, 0x08);
 313   2          tp28xx_byte_write(0x11, 0x54);
 314   2          tp28xx_byte_write(0x13, 0x24);
 315   2          tp28xx_byte_write(0x14, 0x04);
 316   2          tp28xx_byte_write(0x40, 0x00);
 317   2        }
 318   1      }
 319          static void TP2825B_SYSCLK_V1(void)
 320          {
 321   1        if(TP2860 == chip)
 322   1        {
 323   2          tp28xx_byte_write(0x40, 0x08);
 324   2          tp28xx_byte_write(0x12, 0x54);
 325   2          tp28xx_byte_write(0x13, 0xef);        
 326   2          tp28xx_byte_write(0x14, 0x41);
 327   2          tp28xx_byte_write(0x15, 0x02);    
 328   2          tp28xx_byte_write(0x40, 0x00);
 329   2          tp28xx_byte_write(0xfa, 0x00);      
 330   2        }
 331   1        else
 332   1        { 
 333   2          tp28xx_byte_write(0x40, 0x08);
 334   2          tp28xx_byte_write(0x11, 0x54);
 335   2          tp28xx_byte_write(0x13, 0x04);
 336   2          tp28xx_byte_write(0x14, 0x04);  
 337   2          tp28xx_byte_write(0x40, 0x00);
 338   2        }   
 339   1      }
 340          static void TP2825B_SYSCLK_V3(void)
 341          {
 342   1        BYTE tmp;
 343   1        if(TP2860 == chip)
 344   1        {
 345   2          tp28xx_byte_write(0x40, 0x08);
 346   2          tp28xx_byte_write(0x14, 0x00);
 347   2          tp28xx_byte_write(0x15, 0x01);    
 348   2          tp28xx_byte_write(0x40, 0x00);
 349   2          tp28xx_byte_write(0xfa, 0x00);  
 350   2        }
 351   1        else
 352   1        {
 353   2          tp28xx_byte_write(0x40, 0x08);
 354   2          tp28xx_byte_write(0x11, 0x54);
 355   2          tp28xx_byte_write(0x13, 0x04);
 356   2          tp28xx_byte_write(0x14, 0x73);  
 357   2          tp28xx_byte_write(0x40, 0x00);
 358   2        }
 359   1          if(!BT1120_out)
 360   1          {
 361   2            tmp = tp28xx_byte_read(0x35);
 362   2            tmp |= 0x40;
 363   2            tp28xx_byte_write(0x35, tmp); 
 364   2          }   
 365   1      }
 366          void Set_VidRes(BYTE Res, BYTE Std){
 367   1      
 368   1      //  BYTE *ptr_Std;
 369   1        BYTE ptz;
 370   1        BYTE i, index, tmp;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 8   

 371   1        
 372   1        half_scaler=0;
 373   1        ptz = PTZ_TVI;
 374   1        index = 0xff;
 375   1        if( TP2860 == chip )
 376   1        {
 377   2          tp28xx_byte_write(0x06, 0x12); 
 378   2        }
 379   1        if(STD_HDA == Std)
 380   1        {
 381   2          ptz = PTZ_HDA_1;  
 382   2          switch(Res){
 383   3              
 384   3              case TP2802_1080P30:
 385   3      
 386   3                     if(en_960P)
 387   3                     {
 388   4      //                 index = 43;
 389   4                       index = 44;
 390   4                       ptz = PTZ_960P30_AHD;
 391   4                        TP2825B_SYSCLK_945(); 
 392   4                        tp28xx_byte_write(0x05, 0x01);
 393   4                        tp28xx_byte_write(0x0e, 0x12);
 394   4                     }
 395   3                    else
 396   3                    {
 397   4      //                  if(TP2860 == chip )
 398   4      //                  {
 399   4      //                    {index = 31; ptz = PTZ_HDA_1;}
 400   4      //                    TP2860_SYSCLK_A1080P();
 401   4      //                  }
 402   4      //                  else
 403   4                        {
 404   5                          {index = 9; }
 405   5                          TP2825B_SYSCLK_V1();               
 406   5                        }                                     
 407   4                   }
 408   3      
 409   3                //ManVidRes = TP2802_1080P30;
 410   3                break;
 411   3                
 412   3              case TP2802_1080P25:
 413   3      
 414   3                     if(en_960P)
 415   3                     {
 416   4                     }
 417   3                    else
 418   3                    {
 419   4      //                  if(TP2860 == chip )
 420   4      //                  {
 421   4      //                    {index = 32; ptz = PTZ_HDA_1;}
 422   4      //                    TP2860_SYSCLK_A1080P();
 423   4      //                  }
 424   4      //                  else
 425   4                        {
 426   5                          {index = 10; }
 427   5                          TP2825B_SYSCLK_V1();               
 428   5                        }                                     
 429   4                   }
 430   3      
 431   3                //ManVidRes = TP2802_1080P30;
 432   3                break;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 9   

 433   3                  
 434   3              case TP2802_720P30V2:
 435   3      //             if(TP2860 == chip)
 436   3      //             {
 437   3      //              {index = 29; ptz = PTZ_HDA_2;}
 438   3      //              TP2860_SYSCLK_A720P();               
 439   3      //             }
 440   3      //             else
 441   3                   {
 442   4                    {index = 7;}
 443   4                    TP2825B_SYSCLK_V2();               
 444   4                   }
 445   3                //ManVidRes = TP2802_720P30;
 446   3                break;      
 447   3              case TP2802_720P25V2:
 448   3      //             if(TP2860 == chip)
 449   3      //             {
 450   3      //              {index = 30; ptz = PTZ_HDA_2;}
 451   3      //              TP2860_SYSCLK_A720P();               
 452   3      //             }
 453   3      //             else
 454   3                   {
 455   4                    {index = 8;}
 456   4                    TP2825B_SYSCLK_V2();               
 457   4                   }
 458   3                //ManVidRes = TP2802_720P30;
 459   3                break;
 460   3              case TP2802_5M12:
 461   3                {index = 22;}
 462   3                TP2825B_SYSCLK_V1();
 463   3                //ManVidRes = TP2802_1080P30;
 464   3                break;
 465   3              case TP2802_WXGA:
 466   3                   if( TP2860 == chip )
 467   3                   {
 468   4      
 469   4                        {index = 38; ptz = PTZ_HDA_1;}
 470   4                      tp28xx_byte_write(0x05, 0xfd);
 471   4                        tp28xx_byte_write(0x0e, 0x16);
 472   4                   }          
 473   3                  else 
 474   3                  {
 475   4                      index = 38;
 476   4                  }
 477   3                  TP2825B_SYSCLK_54M();
 478   3                
 479   3                //ManVidRes = TP2802_1080P30;
 480   3                break;            
 481   3            }   
 482   2        }
 483   1        else if(STD_HDC == Std || STD_HDC_DEFAULT == Std)
 484   1        {
 485   2        }
 486   1        else
 487   1        {
 488   2            switch(Res){
 489   3              
 490   3              case TP2802_1080P30:
 491   3                   if(en_960P)
 492   3                   {
 493   4                     if(TP2860 == chip)
 494   4                     {
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 10  

 495   5                       if(en_tvi960p_H1400)
 496   5                       {
 497   6                        index = 46;
 498   6                        TP2825B_SYSCLK_945(); 
 499   6                       }
 500   5                       else
 501   5                       {
 502   6                        index = 36;
 503   6                        TP2860_SYSCLK_111375K();
 504   6                       }
 505   5                     }
 506   4                     else
 507   4                     {
 508   5                     
 509   5                       if(en_tvi960p_H1400)
 510   5                       {
 511   6                        index = 46;
 512   6                        TP2825B_SYSCLK_945(); 
 513   6                       }
 514   5                       else
 515   5                       {
 516   6                        index = 40;
 517   6                        TP2825B_SYSCLK_54M(); 
 518   6                       }
 519   5                     }
 520   4                   }
 521   3                  else
 522   3                  {
 523   4                    index = 5;
 524   4                    TP2825B_SYSCLK_V1();
 525   4                  }
 526   3                //ManVidRes = TP2802_1080P30;
 527   3                break;
 528   3      
 529   3              case TP2802_1080P_X3C:
 530   3      
 531   3                    index = 47;
 532   3                    TP2825B_SYSCLK_V1();
 533   3      
 534   3                //ManVidRes = TP2802_1080P30;
 535   3                break;
 536   3                
 537   3              case TP2802_1080P25:
 538   3                   if(en_960P)
 539   3                   {
 540   4                     if(TP2860 == chip)
 541   4                     {
 542   5                       index = 37;
 543   5                        TP2860_SYSCLK_111375K();
 544   5                     }
 545   4                     else
 546   4                     {
 547   5                       index = 41;
 548   5                        TP2825B_SYSCLK_54M();                
 549   5                     }       
 550   4                   }
 551   3                  else
 552   3                  {
 553   4                    index = 6;
 554   4                    TP2825B_SYSCLK_V1();
 555   4                  }
 556   3                //ManVidRes = TP2802_1080P25;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 11  

 557   3                break;
 558   3                  
 559   3              case TP2802_720P30V2:
 560   3      
 561   3                    index = 3;
 562   3                ptz = PTZ_TVI_720P;
 563   3                TP2825B_SYSCLK_V2();
 564   3                //ManVidRes = TP2802_720P30;
 565   3                break;
 566   3              
 567   3              case TP2802_720P25V2:
 568   3                    index = 4;
 569   3                ptz = PTZ_TVI_720P;
 570   3                TP2825B_SYSCLK_V2();
 571   3                //ManVidRes = TP2802_720P30;
 572   3                break;  
 573   3              
 574   3              case TP2802_720P60:
 575   3                    index = 11;
 576   3                TP2825B_SYSCLK_V1();
 577   3                //ManVidRes = TP2802_720P30;
 578   3                break;
 579   3              
 580   3              case TP2802_720P50:
 581   3                    index = 12;
 582   3                TP2825B_SYSCLK_V1();
 583   3                //ManVidRes = TP2802_720P30;
 584   3      
 585   3                break;
 586   3              case TP2802_QHD30:
 587   3                    index = 13;
 588   3                TP2825B_SYSCLK_V3();
 589   3              half_scaler=1;
 590   3                //ManVidRes = TP2802_1080P30;
 591   3                break;      
 592   3              
 593   3              case TP2802_QHD25:
 594   3                    index = 14;
 595   3                TP2825B_SYSCLK_V3();
 596   3                      half_scaler=1;
 597   3                //ManVidRes = TP2802_1080P30;
 598   3                break;    
 599   3      
 600   3              case TP2802_QHD275:
 601   3                    index = 49;
 602   3                TP2825B_SYSCLK_V3();
 603   3                      half_scaler=1;
 604   3                //ManVidRes = TP2802_1080P30;
 605   3                break;          
 606   3      
 607   3              case TP2802_720P30:
 608   3                index = 15;
 609   3                TP2825B_SYSCLK_V1();
 610   3                //ManVidRes = TP2802_720P30;
 611   3                break;
 612   3      
 613   3              case TP2802_720P25:
 614   3              index = 16;
 615   3                TP2825B_SYSCLK_V1();
 616   3                //ManVidRes = TP2802_720P30;
 617   3                break;
 618   3      #if 0
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 12  

                      case TP2802_8M15:
                        index = 17;
                        TP2825B_SYSCLK_V3();
                        //ManVidRes = TP2802_1080P30;
                        break;
              
                      case TP2802_8M12:
                        index = 18;
                        TP2825B_SYSCLK_V3();
                        //ManVidRes = TP2802_1080P30;
                        break;
                      
                      case TP2802_5M20:
                        index = 19;
                        TP2825B_SYSCLK_V3();
                        //ManVidRes = TP2802_1080P30;
                        break;  
              #endif        
 637   3              case TP2802_1080P60:
 638   3                index = 20;
 639   3                TP2825B_SYSCLK_V3();
 640   3                //ManVidRes = TP2802_1080P30;
 641   3                break;    
 642   3              case TP2802_1080P50:
 643   3                index = 45;
 644   3                TP2825B_SYSCLK_V3();
 645   3                //ManVidRes = TP2802_1080P30;
 646   3                break;                  
 647   3              case TP2802_NTSC:
 648   3      
 649   3                ptz = PTZ_CVBS;
 650   3                TP2825B_SYSCLK_V2();
 651   3                   if(TP2860 == chip)
 652   3                   {
 653   4                    index = 34; tp28xx_byte_write(0x06, 0x32); tp28xx_byte_write(0xfa, 0x04); 
 654   4                   }
 655   3                   else
 656   3                   {
 657   4                    index = 1;
 658   4                   }          
 659   3                break;
 660   3      
 661   3              case TP2802_PAL:
 662   3      
 663   3                ptz = PTZ_CVBS;
 664   3                TP2825B_SYSCLK_V2();
 665   3                   if(TP2860 == chip)
 666   3                   {
 667   4                    index = 35; tp28xx_byte_write(0x06, 0x32); tp28xx_byte_write(0xfa, 0x04); 
 668   4                   }
 669   3                   else
 670   3                   {
 671   4                    index = 2;
 672   4                   }          
 673   3                break;
 674   3      #if 0            
                      case TP2802_5M12:
                        index = 21;
                        TP2825B_SYSCLK_V1();
                        //ManVidRes = TP2802_1080P30;
                        break;  
              #endif        
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 13  

 681   3              case TP2802_720P30HDR:
 682   3                index = 23;
 683   3                ptz = PTZ_TVI_720P;
 684   3                TP2825B_SYSCLK_V2();
 685   3                //ManVidRes = TP2802_1080P30;
 686   3                break;  
 687   3              case TP2802_720P25HDR:
 688   3                index = 42;
 689   3                ptz = PTZ_TVI_720P;
 690   3                TP2825B_SYSCLK_V2();
 691   3                //ManVidRes = TP2802_1080P30;
 692   3                break;          
 693   3              case TP2802_WXGA:
 694   3                index = 24;
 695   3                TP2825B_SYSCLK_945();
 696   3                tp28xx_byte_write(0x0b, 0x80);
 697   3                //ManVidRes = TP2802_1080P30;
 698   3                break;          
 699   3              case TP2802_720P864M:
 700   3                index = 48;
 701   3                TP2825B_SYSCLK_864();
 702   3                tp28xx_byte_write(0x0b, 0x80);
 703   3                //ManVidRes = TP2802_1080P30;
 704   3                break;  
 705   3                
 706   3              case TP2802_1080P27:
 707   3                    index = 25;
 708   3                TP2825B_SYSCLK_V1();
 709   3                //ManVidRes = TP2802_1080P30;
 710   3                break;
 711   3                
 712   3              case TP2802_1080P24:
 713   3      
 714   3                    index = 26;;
 715   3                
 716   3                TP2825B_SYSCLK_V1();
 717   3                //ManVidRes = TP2802_1080P30;
 718   3                break;  
 719   3              
 720   3              case TP2802_1080P15:
 721   3      
 722   3                    index = 27;;
 723   3                ptz = PTZ_TVI_720P;
 724   3                TP2825B_SYSCLK_V2();
 725   3                //ManVidRes = TP2802_1080P30;
 726   3                break;  
 727   3      #if 0       
                      case TP2802_1280x320P60:
              
                            index = 28;;
                        ptz = PTZ_TVI_720P;
                        TP2825B_SYSCLK_V2();
                        //ManVidRes = TP2802_1080P30;
                        break;
              #endif
 736   3              case TP2802_480P20:
 737   3      
 738   3                    index = 50;;
 739   3                ptz = PTZ_TVI_720P;
 740   3              //  tp28xx_byte_write(0x13, 0x00);  
 741   3              //  tp28xx_byte_write(0x14, 0x00);          
 742   3                tp28xx_byte_write(0x05, 0x2D);  
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 14  

 743   3                tp28xx_byte_write(0x0E, 0x05);          
 744   3                TP2825B_SYSCLK_54M();
 745   3                tp28xx_byte_write(0xfa, 0x04);          
 746   3                      half_scaler=1;        
 747   3                //ManVidRes = TP2802_1080P30;
 748   3                break;
 749   3              
 750   3              case TP2802_960P25:
 751   3                   if(TP2860 == chip)
 752   3                   {
 753   4                    {index = 33; ptz = PTZ_HDA_1;}
 754   4                    TP2860_SYSCLK_A1080P();            
 755   4                   }
 756   3                   else
 757   3                   {
 758   4      
 759   4                   }
 760   3                break;    
 761   3            
 762   3            }   
 763   2        }
 764   1        if(index != 0xff)
 765   1        {
 766   2            for(i = 0; i < 32; i++)
 767   2            {
 768   3              tp28xx_byte_write(TP2825B_FORMAT_DataSet[0][i],TP2825B_FORMAT_DataSet[index][i]);
 769   3            }
 770   2            
 771   2            if(BT1120_out)
 772   2            {
 773   3              tmp = tp28xx_byte_read(0x02);
 774   3              tmp &= 0x7f;
 775   3              tp28xx_byte_write(0x02, tmp); 
 776   3            }
 777   2            TP2825B_SetTX(ptz);
 778   2            TP2825B_SetRX(ptz); 
 779   2            
 780   2            tmp = tp28xx_byte_read(0x06);
 781   2            tmp |= 0x80;
 782   2            tp28xx_byte_write(0x06, tmp);       
 783   2            
 784   2            Printf("\r\nset video %02x std %02x...", (WORD)Res,(WORD)Std);
 785   2        }
 786   1      }
 787          
 788          static void TP2825B_reset_default()
 789          {
 790   1        unsigned char tmp;
 791   1        
 792   1        TP2825B_SYSCLK_V1();
 793   1        tp28xx_byte_write(0x35, 0x05);
 794   1        tp28xx_byte_write(0x07, 0xc0);
 795   1        tp28xx_byte_write(0x0b, 0xc0);
 796   1        tp28xx_byte_write(0x26, 0x04);
 797   1          tmp = tp28xx_byte_read(0x06);
 798   1          tmp &= 0xfb;
 799   1          tp28xx_byte_write(0x06, tmp); 
 800   1        
 801   1        if(TP2860 == chip)
 802   1        {   
 803   2          tp28xx_byte_write(0xf6, 0x00);
 804   2          tp28xx_byte_write(0xfa, 0x88);
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 15  

 805   2        }
 806   1        if(0==MD0_2) 
 807   1        {
 808   2          //half_scaler=1;
 809   2          //Printf("\r\nHalf mode enable");
 810   2        }
 811   1        else
 812   1        {
 813   2          //half_scaler=0;
 814   2        }
 815   1      }
 816          //////////////////////////////////////////////////////
 817          //
 818          //////////////////////////////////////////////////////
 819          static void TP2850EVK_Switch_Vin(void)
 820          {
 821   1        unsigned char tmp;
 822   1      
 823   1          tmp = tp28xx_byte_read(0x41);
 824   1          tmp &= 0x07;
 825   1        if (0x00 == ManSelCh)
 826   1        {
 827   2            tmp = 0x06;
 828   2        } 
 829   1        else if(0x02 == ManSelCh)
 830   1        {
 831   2            tmp = 0x03;
 832   2        } 
 833   1        else if(0x01 == ManSelCh)
 834   1        {
 835   2            tmp = 0x02;
 836   2        }
 837   1        else 
 838   1        {     
 839   2            if(0x06 == tmp) tmp = 0x02;
 840   2            else if(0x02 == tmp) tmp = 0x03;
 841   2            else if (0x03 == tmp) tmp = 0x06;
 842   2            else tmp = 0x02;
 843   2        }
 844   1      
 845   1          tp28xx_byte_write(0x41, tmp);
 846   1        
 847   1              if(0x06 == tmp)
 848   1              {
 849   2                  tmp = tp28xx_byte_read(0xf0); //differential 1 with inside PTZ1
 850   2                  tmp &= 0xcf;
 851   2                  tmp |= 0x10;
 852   2                  tp28xx_byte_write(0xf0, tmp);                                 
 853   2                tp28xx_byte_write(0x38, 0x4e); //differential
 854   2                tp28xx_byte_write(0x3d, 0x40);
 855   2                //tp28xx_byte_write(0x3e, 0x80);
 856   2              }
 857   1              else if(0x02 == tmp)
 858   1              {
 859   2                  tmp = tp28xx_byte_read(0xf0); //Vin 3 with inside PTZ2
 860   2                  tmp &= 0xcf;
 861   2                  tmp |= 0x20;
 862   2                  tp28xx_byte_write(0xf0, tmp);                                 
 863   2                tp28xx_byte_write(0x38, 0x00); //single-end
 864   2                tp28xx_byte_write(0x3d, 0x60);
 865   2                //tp28xx_byte_write(0x3e, 0x80);
 866   2              }       
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 16  

 867   1              else
 868   1              {
 869   2                tp28xx_byte_write(0x38, 0x00);  //single-end
 870   2                tp28xx_byte_write(0x3d, 0x60);
 871   2                //tp28xx_byte_write(0x3e, 0x00);
 872   2              } 
 873   1      }
 874          /////////////////////////////////////////////////////////
 875          //
 876          ////////////////////////////////////////////////////////
 877          static void TP2825BEVK_Switch_Vin(void)
 878          {
 879   1        unsigned char tmp;
 880   1      
 881   1          tmp = tp28xx_byte_read(0x41);
 882   1          tmp &= 0x07;
 883   1        if (0x00 == ManSelCh)
 884   1        {
 885   2            tmp = 0x04;
 886   2        } 
 887   1        else if(0x02 == ManSelCh)
 888   1        {
 889   2            tmp = 0x06;
 890   2        } 
 891   1        else if(0x01 == ManSelCh)
 892   1        {
 893   2            tmp = 0x07;
 894   2        }
 895   1        else 
 896   1        {     
 897   2            if(0x06 == tmp) tmp = 0x07;
 898   2            else if(0x07 == tmp) tmp = 0x04;
 899   2            else if (0x04 == tmp) tmp = 0x06;
 900   2            else tmp = 0x04;
 901   2        }
 902   1      
 903   1          tp28xx_byte_write(0x41, tmp);
 904   1        
 905   1              if(0x06 == tmp)
 906   1              {
 907   2                  tmp = tp28xx_byte_read(0xf0); //differential 1 with inside PTZ1
 908   2                  tmp &= 0xcf;
 909   2                  tmp |= 0x10;
 910   2                  tp28xx_byte_write(0xf0, tmp);                                 
 911   2                tp28xx_byte_write(0x38, 0x4e); //differential
 912   2                tp28xx_byte_write(0x3d, 0x40);
 913   2                //tp28xx_byte_write(0x3e, 0x80);
 914   2              }
 915   1              else if(0x07 == tmp)
 916   1              {
 917   2                  tmp = tp28xx_byte_read(0xf0); //differential 2 with inside PTZ2
 918   2                  tmp &= 0xcf;
 919   2                  tmp |= 0x20;
 920   2                  tp28xx_byte_write(0xf0, tmp);                                 
 921   2                tp28xx_byte_write(0x38, 0x4e); //differential
 922   2                tp28xx_byte_write(0x3d, 0x40);
 923   2                //tp28xx_byte_write(0x3e, 0x80);
 924   2              }       
 925   1              else
 926   1              {
 927   2                if(0x04 == tmp) //vin5 with inside PTZ2
 928   2                {
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 17  

 929   3                  tmp = tp28xx_byte_read(0xf0);
 930   3                  tmp &= 0xcf;
 931   3                  tmp |= 0x20;
 932   3                  tp28xx_byte_write(0xf0, tmp);
 933   3                }
 934   2                tp28xx_byte_write(0x38, 0x40);  //single-end
 935   2                tp28xx_byte_write(0x3d, 0x60);
 936   2                //tp28xx_byte_write(0x3e, 0x00);
 937   2              } 
 938   1      }
 939          //////////////////////////////////////////////////////////////////////////////
 940          void EQ_Detect(){
 941   1      
 942   1        
 943   1        BYTE cvstd,status,i;
 944   1        BYTE gain, tmp;
 945   1      
 946   1       
 947   1                  //for(i = 0; i < CH_PER_CHIP; i++)//scan four inputs:
 948   1                  i = 0;
 949   1                  {
 950   2                          //SetRegPage(i);
 951   2                          status = tp28xx_byte_read(0x01);
 952   2      
 953   2                          //state machine for video checking
 954   2                          if(status & FLAG_LOSS)
 955   2                          {
 956   3      
 957   3                                  if(VIDEO_UNPLUG == state[i])
 958   3                                  {
 959   4                                      if(count[i] < MAX_COUNT) count[i]++;
 960   4                                        if(TP2825B == chip)
 961   4                                          TP2825BEVK_Switch_Vin();
 962   4                                        else
 963   4                                          TP2850EVK_Switch_Vin();
 964   4                                  }
 965   3                                  else
 966   3                                  {
 967   4                                      state[i] = VIDEO_UNPLUG;
 968   4                                      count[i] = 0;
 969   4                                      std[i] = INVALID_FORMAT;
 970   4                                      TP2825B_reset_default();
 971   4                                      //Set_VidRes(mode[i], STD_TVI);
 972   4                                      Printf("video loss ch%02x \r\n", (WORD)i);
 973   4                                  }
 974   3      
 975   3                          }
 976   2                          else
 977   2                          {
 978   3                              if( FLAG_LOCKED == (status & FLAG_LOCKED) ) //video locked
 979   3                              {
 980   4                                  if(VIDEO_LOCKED == state[i])
 981   4                                  {
 982   5                                      if(count[i] < MAX_COUNT) count[i]++;
 983   5                                  }
 984   4                                  else if(VIDEO_UNPLUG == state[i])
 985   4                                  {
 986   5                                      state[i] = VIDEO_IN;
 987   5                                      count[i] = 0;
 988   5                                  }
 989   4                                  else if(mode[i] != INVALID_FORMAT)
 990   4                                  {
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 18  

 991   5      
 992   5                                      state[i] = VIDEO_LOCKED;
 993   5                                      count[i] = 0;
 994   5                                  }   
 995   4      /*                            
 996   4                                  else
 997   4                                  {
 998   4                                      state[i] = VIDEO_LOCKED;
 999   4                                      count[i] = 0;
1000   4                                      Printf("video locked ch%02x \r\n", (WORD)i);
1001   4                                  }
1002   4      */
1003   4                              }
1004   3                              else  //video in but unlocked
1005   3                              {
1006   4                                  if(VIDEO_UNPLUG == state[i])
1007   4                                  {
1008   5                                      state[i] = VIDEO_IN; count[i] = 0;
1009   5                                      Printf("video in ch%02x \r\n", (WORD)i);
1010   5                                  }
1011   4                                  else if(VIDEO_LOCKED == state[i])
1012   4                                  {
1013   5                                      state[i] = VIDEO_UNLOCK; count[i] = 0;
1014   5                                      Printf("video unstable ch%02x \r\n", (WORD)i);
1015   5                                  }
1016   4                                  else
1017   4                                  {
1018   5                                          if(count[i] < MAX_COUNT) count[i]++;
1019   5                                          if(VIDEO_UNLOCK == state[i] && count[i] > 2)
1020   5                                          {
1021   6                                              state[i] = VIDEO_IN; count[i] = 0;
1022   6                                              TP2825B_reset_default();
1023   6                                              Printf("video unlocked ch%02x \r\n", (WORD)i);
1024   6                                          }
1025   5                                  }
1026   4                              }
1027   3      
1028   3                          }
1029   2      
1030   2                      if( VIDEO_IN == state[i])
1031   2                      {
1032   3                              cvstd = tp28xx_byte_read(0x03);
1033   3                              Printf("video format %2x detected ch%02x \r\n", (WORD)(cvstd), (WORD)i );
1034   3                              sywd = cvstd & 0x08;
1035   3                              cvstd &= 0x07;
1036   3                              std[i] = STD_TVI;
1037   3                              //if(INVALID_FORMAT == cvstd)
1038   3                              if( cvstd > 0x02)
1039   3                              {
1040   4                                       tp28xx_byte_write(0x2f, 0x09);
1041   4                                       tmp = tp28xx_byte_read(0x04);
1042   4                                       Printf("extend format %2x detected ch%02x \r\n", (WORD)(tmp), (WORD)i );
1043   4                                          if(0x4e == tmp)
1044   4                                          {
1045   5      
1046   5                                                 mode[i] = TP2802_3M18;
1047   5                                          } 
1048   4                                          else if(0x38 == tmp)
1049   4                                          {
1050   5      
1051   5                                                 mode[i] = TP2802_QHD275;
1052   5                                          }       
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 19  

1053   4                                          else if(0xd6 == tmp)
1054   4                                          {
1055   5      
1056   5                                                 mode[i] = TP2802_480P20;
1057   5                                          }                                       
1058   4                                          else if(0x4d == tmp)
1059   4                                          {
1060   5                                              if(count[i] & 1)
1061   5                                              {
1062   6                                                  mode[i] = TP2802_1080P_X3C;
1063   6                                                  //tp2802_set_video_mode(iChip, wdi-> mode[i], i,  wdi-> std[i]
             -);
1064   6                                              }
1065   5                                              else
1066   5                                              {
1067   6                                                 mode[i] = TP2802_WXGA;
1068   6                  }
1069   5                                          }                                                                   
1070   4                                          else if(0x5d == tmp)
1071   4                                          {
1072   5                                              if(count[i] & 1)
1073   5                                              {
1074   6                                                  mode[i] = TP2802_5M12;
1075   6                                                  std[i] = STD_HDA;
1076   6                                                  //tp2802_set_video_mode(iChip, wdi-> mode[i], i,  wdi-> std[i]
             -);
1077   6                                              }
1078   5                                              else
1079   5                                              {
1080   6                                                  mode[i] = TP2802_720P30HDR;
1081   6                                                  //std[i] = STD_TVI;
1082   6                                                  //tp2802_set_video_mode(iChip, wdi-> mode[i], i, wdi-> std[i])
             -;
1083   6                                              }
1084   5                                          }
1085   4                                          else if(0x70 == tmp)
1086   4                                          {
1087   5      
1088   5                                                 mode[i] = TP2802_720P25HDR;
1089   5                                          }                                         
1090   4                                          else if(0x5c == tmp)
1091   4                                          {
1092   5                                              mode[i] = TP2802_5M12;
1093   5                                          }
1094   4      /*
1095   4                                          else if(0x75 == tmp)
1096   4                                          {
1097   4                                              wdi-> mode[i] = TP2802_6M10;
1098   4                                              tp2802_set_video_mode(iChip, wdi-> mode[i], i, wdi-> std[i]);
1099   4                                          }
1100   4                                          //else if((tmp > 0x34) && (tmp < 0x40))
1101   4                                          else if(0x38 == tmp)
1102   4                                          {
1103   4                                              wdi-> mode[i] = TP2802_QXGA25; //current only HDA
1104   4                                              wdi-> std[i] = STD_HDA;
1105   4                                              tp2802_set_video_mode(iChip, wdi-> mode[i], i, wdi-> std[i]);
1106   4                                          }
1107   4                                          //else if((tmp > 0x28) && (tmp < 0x34))
1108   4                                          else if(0x2e == tmp)
1109   4                                          {
1110   4                                              wdi-> mode[i] = TP2802_QXGA30; //current only HDA
1111   4                                              wdi-> std[i] = STD_HDA;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 20  

1112   4                                              tp2802_set_video_mode(iChip, wdi-> mode[i], i, wdi-> std[i]);
1113   4                                          }
1114   4      */  
1115   4                                          else if(0x3a == tmp)  // invalid for TP2853C
1116   4                                          {
1117   5                                              mode[i] = TP2802_5M20;
1118   5                                          }
1119   4                                          
1120   4                                          else if(0x89 == tmp)
1121   4                                          {
1122   5                                              mode[i] = TP2802_1080P15;
1123   5                                          }
1124   4                                          
1125   4                                          else if(0x22 == tmp)
1126   4                                          {
1127   5                                              mode[i] = TP2802_1080P60;
1128   5                                          }
1129   4                                          else if(0x29 == tmp)
1130   4                                          {
1131   5                                              mode[i] = TP2802_1080P50;
1132   5                                          }                                     
1133   4                                          else if(0x4a == tmp)
1134   4                                          {
1135   5                                              mode[i] = TP2802_1080P27;
1136   5                                          }                                       
1137   4                                          else if(0x55 == tmp)
1138   4                                          {
1139   5                                              if(count[i] & 1)
1140   5                                              {
1141   6                                                  mode[i] = TP2802_720P864M;
1142   6                                                  //tp2802_set_video_mode(iChip, wdi-> mode[i], i,  wdi-> std[i]
             -);
1143   6                                              }
1144   5                                              else
1145   5                                              {
1146   6                                                mode[i] = TP2802_1080P24;
1147   6                  }                                    
1148   5                                              
1149   5                                          }           
1150   4                                          else if(0x94 == tmp)
1151   4                                          {
1152   5                                              mode[i] = TP2802_PAL;
1153   5                                          }                                       
1154   4                                          else if(0x93 == tmp)
1155   4                                          {
1156   5                                              mode[i] = TP2802_NTSC;
1157   5                                          }     
1158   4                                          else if(0x54 == tmp)
1159   4                                          {
1160   5                                              mode[i] = TP2802_960P25;
1161   5                                          } 
1162   4                                          else if(0x55 == tmp)
1163   4                                          {
1164   5                                              mode[i] = TP2802_720P864M;
1165   5                                          }                   
1166   4                                          else if(0x52 == tmp) 
1167   4                                          {
1168   5                                                  mode[i] = TP2802_1080P25;
1169   5                                                  if(count[i] & 0x01)
1170   5                                                  {
1171   6                                                      //mode[i] = TP2802_WXGA; 
1172   6                                                      //mode[i] = TP2802_8M12;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 21  

1173   6                                                  } 
1174   5                                          } 
1175   4                                          else if(0x67 == tmp)
1176   4                                          {
1177   5                                              if(count[i] & 0x01)
1178   5                                                mode[i] = TP2802_1280x320P60;
1179   5                                              else
1180   5                                                mode[i] = TP2802_720P30V2;
1181   5                                          }
1182   4                                          else if(0x7b == tmp)
1183   4                                          {
1184   5                                              mode[i] = TP2802_720P25V2;
1185   5                                          }                                             
1186   4                                          //Set_VidRes(mode[i], STD_TVI);
1187   4                              }
1188   3      /*                        
1189   3                              else if(TP2802_SD == cvstd)
1190   3                              {
1191   3                                               
1192   3                                      if(count[i] & 0x01)
1193   3                                      {
1194   3       
1195   3                                          mode[i] = TP2802_PAL;
1196   3                                      }
1197   3                                      else
1198   3                                      {
1199   3                                          mode[i] = TP2802_NTSC;
1200   3      
1201   3                                      }
1202   3                                      //Set_VidRes(mode[i], STD_TVI);
1203   3                                                                  
1204   3                              }
1205   3      */  
1206   3                              
1207   3                              else
1208   3                              {
1209   4                                      mode[i] = cvstd;
1210   4                      
1211   4                                      if(DetAutoStd)
1212   4                                      {
1213   5                                      
1214   5                                          if( TP2802_1080P30 == cvstd )
1215   5                                          {
1216   6                                            if(en_960P)
1217   6                                            {
1218   7                                              if(!en_tvi960p_H1400)
1219   7                                                std[i]= std[i] = STD_HDA;
1220   7                                            }
1221   6      /*                                      
1222   6                                                  if(count[i] & 0x01)
1223   6                                                  {
1224   6                                                      mode[i] = TP2802_8M15;
1225   6                                                  }
1226   6      */
1227   6                                          }
1228   5                                          else if( TP2802_720P60 == cvstd )
1229   5                                          {
1230   6                                                  if(count[i] & 0x01)
1231   6                                                  {
1232   7                                                      mode[i] = TP2802_QHD30;
1233   7                                                  }
1234   6                                          }
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 22  

1235   5                                          else if( TP2802_720P50 == cvstd )
1236   5                                          {
1237   6                                                  if(count[i] & 0x01)
1238   6                                                  {
1239   7                                                      mode[i] = TP2802_QHD25;
1240   7                                                  } 
1241   6                                          }
1242   5                                      }                               
1243   4                                      //Set_VidRes(mode[i], STD_TVI);
1244   4                              }
1245   3                              
1246   3                              Set_VidRes(mode[i], std[i]);
1247   3      
1248   3                        }
1249   2      #define EQ_COUNT 10
1250   2                              if( VIDEO_LOCKED == state[i]) //check signal lock
1251   2                              {
1252   3                                  if(0 == count[i])
1253   3                                  {
1254   4                                    Printf("count=0 \r\n");
1255   4                                    //count[i]++;
1256   4                                    
1257   4                                    
1258   4                                    
1259   4                                          tmp = tp28xx_byte_read(0x26);
1260   4                                          //tmp &= 0xfc;
1261   4                                          tmp |= 0x01;
1262   4                                          tp28xx_byte_write(0x26, tmp); 
1263   4                                          if( (TP2802_720P30V2 == mode[i]) || (TP2802_720P25V2 == mode[i]) )
1264   4                                          {
1265   5                                                                  if( !(0x08 & tp28xx_byte_read(0x03)))
1266   5                                                                  {
1267   6      
1268   6                                                                      Printf("720P V1 Detected ch%02x \r\n", (WO
             -RD)i);
1269   6                                                                      if(TP2802_720P30V2 == mode[i]) //to speed 
             -the switching
1270   6                                                                      {
1271   7                                                                          mode[i] = TP2802_720P30;
1272   7                                                                      }
1273   6                                                                      else if (TP2802_720P25V2 == mode[i])
1274   6                                                                      {
1275   7                                                                          mode[i] = TP2802_720P25;
1276   7                                                                      }
1277   6                                                                      Set_VidRes(mode[i], STD_TVI);
1278   6      
1279   6                                                                  }                             
1280   5      
1281   5                                           }
1282   4      
1283   4      
1284   4      
1285   4                                      
1286   4                                      if(ManVidRes != mode[i])
1287   4                                      {
1288   5      /*                                  
1289   5                                            if(mode[i] > TP2802_NTSC && ManVidRes == TP2802_1080P30)
1290   5                                            {
1291   5                                            }
1292   5                                            else if(mode[i] < TP2802_720P25 && ManVidRes == TP2802_1080P30)
1293   5                                            {
1294   5                                            }
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 23  

1295   5                                            else if(mode[i] > TP2802_1080P30 && mode[i] < TP2802_PAL && ManVidRes == TP2802_720P30)
1296   5                                            {
1297   5                                            }
1298   5                                            else
1299   5      */                                  
1300   5                                            {
1301   6                                              ManVidRes = mode[i];
1302   6                                              CreateMDIN340VideoInstance();
1303   6                                            }
1304   5                                      }
1305   4      
1306   4                                  }
1307   3                                  else if(1 == count[i])
1308   3                                  {
1309   4                                    //count[i]++;
1310   4                                    Printf("count=1 \r\n");
1311   4                                    tmp = tp28xx_byte_read(0x01);
1312   4      
1313   4                                    if(TP2802_PAL == mode[i] || TP2802_NTSC == mode[i])
1314   4                                    {
1315   5                                      //do nothing
1316   5                                    }
1317   4                                    else if(0x60 == (tmp&0x64) && DetAutoStd )
1318   4                                    {
1319   5                          
1320   5      //                                UTC_data = tp28xx_byte_read(0x94);
1321   5                                      Printf("UTC set\r\n");
1322   5      //                                        if     (0xff == UTC_data)                {std[i] = STD_HDC;}
1323   5      //                                        else if(0x00 == UTC_data)                std[i] = STD_HDC_DEFAUL
             -T;
1324   5      //                                        else                                   {std[i] = STD_HDA;}
1325   5                                      if(std[i] == STD_TVI)
1326   5                                      {
1327   6                                           std[i] = STD_HDA;
1328   6                                           Set_VidRes(mode[i], std[i]);
1329   6                                      }
1330   5                                        //TP2825B_SetRX(0x02);
1331   5                                    }
1332   4                                    else
1333   4                                    {
1334   5                                      if(std[i] == STD_HDA && DetAutoStd  )
1335   5                                      {
1336   6                                           std[i] = STD_TVI;
1337   6                                           Set_VidRes(mode[i], std[i]);
1338   6                                      }                               
1339   5                                      //TP2825B_SetRX(0); //TVI 
1340   5                                    }
1341   4                                    
1342   4                                    if(half_scaler) //down scaler output
1343   4                                      {
1344   5                                        tmp = tp28xx_byte_read(0x35);
1345   5                                        tmp |= 0x40;
1346   5                                        tp28xx_byte_write(0x35, tmp);
1347   5                                      }
1348   4                                  }
1349   3                                  else if( count[i] < EQ_COUNT-3)
1350   3                                  {
1351   4      
1352   4                                      egain[i][3] = egain[i][2];
1353   4                                      egain[i][2] = egain[i][1];
1354   4                                      egain[i][1] = egain[i][0];
1355   4                                      gain = tp28xx_byte_read(0x03);
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 24  

1356   4                                      //egain[i][EQ_COUNT - count[i]] = gain&0xf0;
1357   4                                      egain[i][0] = gain&0xf0;
1358   4                                      Printf("Egain=0x%02x ch%02x\r\n", (WORD)gain, (WORD)i);
1359   4      
1360   4                                  }
1361   3                                  else if( EQ_COUNT == count[i])
1362   3                                  {
1363   4                                      count[i]--;
1364   4      
1365   4                                      egain[i][3] = egain[i][2];
1366   4                                      egain[i][2] = egain[i][1];
1367   4                                      egain[i][1] = egain[i][0];
1368   4      
1369   4                                      gain = tp28xx_byte_read(0x03);
1370   4                                      egain[i][0] = gain&0xf0;
1371   4                                      if(abs(egain[i][3] - egain[i][0])< 0x20 && abs(egain[i][2] - egain[i][0])< 0x20 && abs(ega
             -in[i][1] - egain[i][0])< 0x20 )
1372   4                                      {
1373   5      
1374   5                                          count[i]++;
1375   5      
1376   5                                              tmp = tp28xx_byte_read(0x03);
1377   5                                              Printf("result Egain=0x%02x ch%02x\r\n", (WORD)tmp, (WORD)i);
1378   5      
1379   5                                      }
1380   4                                  }
1381   3      
1382   3                                  else if(EQ_COUNT+1 == count[i])
1383   3                                  {
1384   4                                      tp28xx_byte_write(0x2f, 00);
1385   4                                      gain = tp28xx_byte_read(0x04);
1386   4      
1387   4                                            if( STD_TVI !=  std[i] )
1388   4                                            {
1389   5                                                  //tp28xx_byte_write(iChip, 0x07, 0x80|(gain>>2));  // manual mode
1390   5                                                  //tp28xx_byte_write(0x07, 0x80|(gain>>2));
1391   5                                            }
1392   4      
1393   4                                  }
1394   3                                  else if(EQ_COUNT+2 == count[i])
1395   3                                  {
1396   4                                    //count[i]++;
1397   4                                    if(STD_HDC_DEFAULT == std[i] )
1398   4                                    {
1399   5                                                  
1400   5                                        tp28xx_byte_write(0x2f, 0x0c);
1401   5                                                  
1402   5                                        tmp = tp28xx_byte_read(0x04);
1403   5                                                  
1404   5                                        status = tp28xx_byte_read(0x01);
1405   5                                                  //if(0x10 == (0x11 & status) && (tmp < 0x18 || tmp > 0xf0))
1406   5                                                  if(0x10 == (0x11 & status))
1407   5                                                  //if((tmp < 0x18 || tmp > 0xf0))
1408   5                                                  {
1409   6                                                      std[i] = STD_HDC;
1410   6                                                    //TP2825B_SetTX(0x05); 
1411   6                                                  }
1412   5                                                  else
1413   5                                                  {
1414   6                                                      std[i] = STD_HDA;
1415   6                                                    //TP2825B_SetTX(0x02); 
1416   6                                                    
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 25  

1417   6                                                  }
1418   5                                                  
1419   5                                                  //Set_VidRes(mode[i], std[i]);
1420   5                                                  //Printf("reg01=%02x reg04@2f=0c %02x std%02x \r\n", (WORD)sta
             -tus, (WORD)tmp, (WORD)std[i]);
1421   5                                                  
1422   5                                              }
1423   4                                              else
1424   4                                              {
1425   5                                                 //TP2825B_SetTX(0x00);
1426   5                                              }
1427   4      
1428   4                                        if( STD_TVI != std[i] )
1429   4                                        {
1430   5                                                //tp2802_manual_agc(iChip, i); //fix AGC when PTZ operation, it c
             -an be removed on TP2826/2827
1431   5                                              //tp283x_egain(iChip, 0x0c);
1432   5                                        }
1433   4                  if(0==MD0_1) 
1434   4                  {
1435   5                    DetAutoStd=0;
1436   5                    Printf("\r\nDebug mode enable");
1437   5                  }
1438   4                                  }
1439   3                                  else
1440   3                                  {
1441   4      /*                              
1442   4                                        if(mode[i] < TP2802_3M18)
1443   4                                        {
1444   4                                                  tmp = tp28xx_byte_read(0x03); //
1445   4                                                  tmp &= 0x07;
1446   4                                                  if(tmp != (mode[i]&0x07) && tmp < TP2802_SD)
1447   4                                                  {
1448   4                                                      state[i] = VIDEO_UNPLUG;
1449   4                                                  }
1450   4                                        }
1451   4      */                              
1452   4                                  }
1453   3      
1454   3      
1455   3                              }
1456   2      
1457   2                      }
1458   1      
1459   1      }
1460          
1461          
1462          
1463          void Init_TP_RegSet(){
1464   1      
1465   1      //  BYTE *ptr_TP;
1466   1        BYTE i;
1467   1      
1468   1        TVII2CAddress = 0x88;
1469   1      
1470   1        if(0x28 == tp28xx_byte_read(0xfe))
1471   1        {
1472   2          
1473   2        }
1474   1        else
1475   1        {
1476   2            TVII2CAddress = 0x8a;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 26  

1477   2        }
1478   1        Printf("\r\nEVK detection address %02x", (WORD)TVII2CAddress);
1479   1        
1480   1        chip = tp28xx_byte_read(0xff);
1481   1        
1482   1        revision = tp28xx_byte_read(0xfc);
1483   1        
1484   1        Printf("\r\ndetection chip %02x rev %02x", (WORD)chip,(WORD)revision);
1485   1      
1486   1      
1487   1        if(TP2825B == chip)
1488   1        {
1489   2          TP2825BEVK_Switch_Vin();
1490   2        }
1491   1        else
1492   1        {
1493   2          TP2850EVK_Switch_Vin();
1494   2        }
1495   1          i = 0;
1496   1          //loss[i] = 1;
1497   1          //locked[i] = 0;
1498   1          count[i] = 0;
1499   1          state[i] = VIDEO_UNPLUG;
1500   1          std[i] = ManVidStd;
1501   1          mode[i] = ManVidRes;
1502   1      
1503   1        if(TP2860 == chip)
1504   1        {
1505   2          I2CDeviceSet(TVII2CAddress,TP2860_DataSet );
1506   2        }
1507   1        else
1508   1        {
1509   2          I2CDeviceSet(TVII2CAddress,TP2825B_DataSet );
1510   2        
1511   2        }
1512   1        
1513   1        TP2825B_reset_default();    //soft reset 
1514   1        
1515   1        Set_VidRes(ManVidRes, ManVidStd);
1516   1        
1517   1      }
1518          //////////////////////////////////////////////////////////////////////////////
1519          void ConvertData(unsigned char dat, unsigned char reg)
1520          {
1521   1         unsigned char i;
1522   1        
1523   1          PTZ_pelco=0;
1524   1      
1525   1       if(0x85 == tp28xx_byte_read(0x1c) && 0x78 == tp28xx_byte_read(0x1d))
1526   1       {  
1527   2          for(i = 0; i < 8; i++)
1528   2          {
1529   3              PTZ_pelco <<= 3;
1530   3      
1531   3              if(0x01 & dat) PTZ_pelco |= 0x06;
1532   3              else PTZ_pelco |= 0x04;
1533   3      
1534   3              dat >>= 1;
1535   3          }
1536   2        }
1537   1        else
1538   1        {
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 27  

1539   2            for(i = 0; i < 8; i++)
1540   2          {
1541   3              PTZ_pelco <<= 3;
1542   3      
1543   3              if(0x80 & dat) PTZ_pelco |= 0x06;
1544   3              else PTZ_pelco |= 0x04;
1545   3      
1546   3              dat <<= 1;
1547   3          } 
1548   2        }
1549   1      /*    
1550   1          PTZ_buf[buf_index]= (PTZ_pelco>>16)&0xff;
1551   1          PTZ_buf[buf_index+1]= (PTZ_pelco>>8)&0xff;
1552   1          PTZ_buf[buf_index+2]= (PTZ_pelco)&0xff;   
1553   1      */
1554   1              tp28xx_byte_write(reg + 0 , (PTZ_pelco>>16)&0xff);
1555   1              tp28xx_byte_write(reg + 1 , (PTZ_pelco>>8)&0xff);
1556   1              tp28xx_byte_write(reg + 2 , (PTZ_pelco)&0xff);    
1557   1      }
1558          
1559          
1560          
1561          void StartTX(void)
1562          {
1563   1            unsigned char tmp,i;
1564   1            
1565   1            tp28xx_byte_write(0xB6, 0x01); //clear flag
1566   1        
1567   1              tmp = tp28xx_byte_read(0x6f);
1568   1              tmp |= 0x01;
1569   1              tp28xx_byte_write(0x6f, tmp); //TX enable 
1570   1              tmp &= 0xfe;
1571   1              tp28xx_byte_write(0x6f, tmp); //TX disable
1572   1              
1573   1            for(i = 0; i <20; i++) //wait TX end
1574   1            {
1575   2                tmp = tp28xx_byte_read(0xB6); 
1576   2                if( 0x01 & tmp) break;
1577   2                delay(2);
1578   2            }
1579   1      }
1580          //////////////////////////////////////////////////////////////////////////////
1581          //PTZ TX
1582          //////////////////////////////////////////////////////////////////////////////
1583          ////////////////////////////////////////////////////////
1584          //send 128byte data on 4 lines with 16bytes x8 times
1585          ///////////////////////////////////////////////////////
1586          void BurstTX(BYTE* buf)
1587          {
1588   1      //  BYTE i,j;
1589   1      //  BYTE *p;
1590   1      //  CODE BYTE TX_ADDR[8]={0x57,0x58,0x59,0x5a,0x5c,0x5d,0x5e,0x5f};
1591   1      //    
1592   1      
1593   1      //  p = buf;
1594   1      //  
1595   1      //    
1596   1      //    tp28xx_byte_write(0x40, 0x10);
1597   1      //    tp28xx_byte_write(0x56, 0x03);
1598   1      //    tp28xx_byte_write(0x5b, 0x03);
1599   1      //    tp28xx_byte_write(0x40, 0x00);
1600   1      //    tp28xx_byte_write(0x56, 0x03);
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 28  

1601   1      //    tp28xx_byte_write(0x5b, 0x03);
1602   1      //    for(j = 0; j < 8; j++)
1603   1      //    {
1604   1      //      for(i = 0; i < 8; i++  ) 
1605   1      //      {
1606   1      //        tp28xx_byte_write(TX_ADDR[i], *p);
1607   1      //        //tp28xx_byte_write(TX_ADDR[i], 16*j+i);
1608   1      //        p++;
1609   1      //      }
1610   1      //      tp28xx_byte_write(0x40, 0x10);
1611   1      //      for(i = 0; i < 8; i++  ) 
1612   1      //      {
1613   1      //        tp28xx_byte_write(TX_ADDR[i], *p);
1614   1      //        //tp28xx_byte_write(TX_ADDR[i], 16*j+i);
1615   1      //        p++;
1616   1      //      }
1617   1      //      tp28xx_byte_write(0x40, 0x00);
1618   1      //      StartTX();
1619   1      //      delay(10); 
1620   1      //    }   
1621   1      
1622   1      }
*** WARNING C280 IN LINE 1586 OF src\TP2825B.c: 'buf': unreferenced local variable
1623          //////////////////////////////////////////////////////////////////////////////
1624          //PTZ RX
1625          //////////////////////////////////////////////////////////////////////////////
1626          void TP2825B_SetRX(BYTE index) 
1627          {
1628   1         unsigned char i;
1629   1          
1630   1          //reg0xc9~d7 A8 A7
1631   1          CODE BYTE PTZ_dat[][17]=
1632   1          {
1633   1              {0x00,0x00,0x07,0x08,0x00,0x00,0x04,0x00,0x00,0x60,0x10,0x06,0xbe,0x39,0x27, 0x00,0x03}, //TVI 108
             -0p/960p
1634   1              {0x00,0x00,0x07,0x08,0x00,0x00,0x02,0x00,0x00,0x60,0x08,0x06,0x5f,0x39,0x27, 0x00,0x03}, //TVI 720p
1635   1              
1636   1              {0x00,0x00,0x06,0x07,0x08,0x09,0x03,0x48,0x34,0x60,0x38,0x04,0xf0,0xd8,0x07, 0x00,0x27}, //AHD 108
             -0p
1637   1              
1638   1            //  {0x00,0x00,0x06,0x07,0x08,0x09,0x03,0x48,0x34,0x60,0x1c,0x04,0xf0,0xd8,0x17, 0x00,0x27}, // AHD 720p
1639   1                {0x00,0x00,0x06,0x07,0x08,0x09,0x06,0x90,0x68,0x60,0x1d,0x04,0xf0,0xd8,0x07, 0x00,0x27}, // AHD 720p 
             -//changed20231103kevin
1640   1              {0x00,0x00,0x07,0x08,0x00,0x00,0x04,0xec,0x4e,0x60,0x10,0x06,0xbe,0x39,0x27, 0x00,0x03}, //BYD new
             - A960p  
1641   1              {0x00,0x00,0x07,0x08,0x00,0x00,0x04,0x00,0x00,0x60,0x10,0x06,0xbe,0x39,0x27, 0x00,0x03}, //TVI 108
             -0p/960p
1642   1              {0x00,0x00,0x07,0x08,0x00,0x00,0x02,0x00,0x00,0x60,0x08,0x06,0x5f,0x39,0x27, 0x00,0x03}, //TVI 720p 
1643   1              {0x00,0x00,0x08,0x09,0x0a,0x0b,0x04,0x69,0xee,0x60,0x2c,0x06,0xbe,0x39,0x07, 0x00,0x27}, //BYD new
             - A960p30          
1644   1          };
1645   1      /* only valid for TP2850/TP2825B    
1646   1          tp28xx_byte_write(0x40, 0x08); //mipi page
1647   1          i = tp28xx_byte_read(0x13);
1648   1          if(0x20&i) index +=1; //720p setting
1649   1          tp28xx_byte_write(0x40, 0x00); //mipi page
1650   1      */
1651   1         if( PTZ_960P == index) index = 4;
1652   1         else if( PTZ_960P30_AHD == index)  index = 7;  
1653   1          for(i = 0; i < 15; i++)
1654   1          {
1655   2              tp28xx_byte_write(0xc9+i, PTZ_dat[index][i]);
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 29  

1656   2          }    
1657   1          tp28xx_byte_write(0xa8, PTZ_dat[index][15]); 
1658   1          tp28xx_byte_write(0xa7, PTZ_dat[index][16]); 
1659   1      
1660   1      }
1661          /*
1662          BYTE MonRX(void) 
1663          {
1664            unsigned char i;
1665            unsigned char tmp;
1666              
1667              for(i = 0; i < 8; i++)
1668              {
1669                    PTZ_buf[i]=0x00; //clear buf
1670              }
1671                tp28xx_byte_write(0xB6, 0x10); //clear flag
1672          
1673                for(i = 0; i < 200; i++) //wait RX end
1674                {
1675                    tmp = tp28xx_byte_read(0xb6);
1676                    tmp &= 0x10;    
1677                    if(tmp) break;
1678                    delay(2);
1679                }
1680          
1681                tp28xx_byte_write(0xB6, 0x10); //clear flag
1682          
1683                if(tmp)
1684                {
1685                  for(i = 0; i < 4; i++)
1686                  {
1687                         PTZ_buf[  i] = tp28xx_byte_read(0x8c+i); //line1
1688                         PTZ_buf[4+i] = tp28xx_byte_read(0x91+i); //line2
1689                  }               
1690                }
1691                
1692                if(tmp )    
1693                {
1694                  tmp = 0;
1695                  for(i = 0; i < 7; i++)
1696                  {
1697                    tmp += PTZ_buf[i];
1698                  } 
1699                  if( tmp == PTZ_buf[7])
1700                  {
1701                    return 0;
1702                  }
1703                  else
1704                  {
1705                    return 2;//packet error
1706                  }
1707                }
1708                else
1709                {
1710                  return 1; //time_out
1711                }
1712                
1713          }
1714          BYTE WaitRX(BYTE data1,data2) 
1715          {
1716            unsigned char i;
1717            unsigned char tmp;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 30  

1718              
1719              for(i = 0; i < 8; i++)
1720              {
1721                    PTZ_buf[i]=0x00; //clear buf
1722              }
1723          
1724                for(i = 0; i < 50; i++) //wait RX end
1725                {
1726                    tmp = tp28xx_byte_read(0x91);
1727                    if(tmp == data1)
1728                    {
1729                      tmp = tp28xx_byte_read(0x92);
1730                      if(tmp == data2) break;
1731                    }
1732                    delay(2);
1733                }
1734          
1735          
1736                if(i < 50)
1737                {
1738                  return 1;
1739                }
1740                else
1741                {
1742                  return 0;
1743                }
1744                
1745          }
1746          */
1747          //////////////////////////////////////////////////////////////////////////////
1748          //PTZ TX
1749          //////////////////////////////////////////////////////////////////////////////
1750          void MonTX(BYTE cmd, BYTE data1, BYTE data2, BYTE data3, BYTE data4) 
1751          {
1752   1        unsigned char i;
1753   1        unsigned char sum;
1754   1        unsigned char tmp;
1755   1      
1756   1          for(i = 0; i < 12; i++)
1757   1          {
1758   2                PTZ_buf[i]=0x00; //clear buf
1759   2          }
1760   1          
1761   1          sum = data1 + data2 + data3 + data4;
1762   1            if(0xfc == cmd)
1763   1            {
1764   2                sum += 0xa6; //0xa5+0x01
1765   2                PTZ_buf[0] = 0xa5;
1766   2                PTZ_buf[1] = 0x01;
1767   2                PTZ_buf[2] = data1;
1768   2                PTZ_buf[3] = data2;
1769   2                PTZ_buf[4] = data3;
1770   2                PTZ_buf[5] = data4; 
1771   2                PTZ_buf[6] = sum;
1772   2            }
1773   1            else
1774   1            {
1775   2                  sum += 0xb5;
1776   2                  sum += cmd;
1777   2                  PTZ_buf[1]=0x02;
1778   2                  PTZ_buf[2]=0xB5;
1779   2                  PTZ_buf[4]=cmd;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 31  

1780   2                  PTZ_buf[5]=data1;
1781   2                  
1782   2                  PTZ_buf[7]=0x02;
1783   2                  PTZ_buf[8]=data2;
1784   2                  PTZ_buf[9]=data3;
1785   2                  PTZ_buf[10]=data4;
1786   2                  PTZ_buf[11]=sum;
1787   2            }
1788   1            
1789   1            if(0xfc == cmd) //HDC 
1790   1            { 
1791   2                     for(i = 0; i < 7; i++)
1792   2                      {
1793   3                          tp28xx_byte_write(0x6e, PTZ_buf[i]);
1794   3                      }
1795   2      
1796   2                      //StartTX(chip, PTZ_data.ch);
1797   2      
1798   2              }       
1799   1              else if(0xff == cmd) //HDA 
1800   1              {
1801   2                
1802   2                      tmp = tp28xx_byte_read(0x02);
1803   2                      if(tmp&0x02)
1804   2                      {
1805   3                        TP2825B_SetRX(PTZ_HDA_2);
1806   3                        TP2825B_SetTX(PTZ_HDA_2);                           
1807   3                      }
1808   2                      else
1809   2                      {
1810   3                        TP2825B_SetRX(PTZ_HDA_1);
1811   3                        TP2825B_SetTX(PTZ_HDA_1);                           
1812   3                      }
1813   2      
1814   2                      if(0x85 == tp28xx_byte_read(0x1c) && 0x78 == tp28xx_byte_read(0x1d))
1815   2                      {
1816   3                        TP2825B_SetRX(PTZ_960P30_AHD);
1817   3                        TP2825B_SetTX(PTZ_960P30_AHD);                          
1818   3                      }               
1819   2      
1820   2                      ConvertData(data1, 0x58);
1821   2                      ConvertData(data2, 0x5e);       
1822   2                      ConvertData(data3, 0x64);
1823   2                      ConvertData(data4, 0x6a);         
1824   2              }
1825   1              else        
1826   1              {
1827   2                      if(0x85 == tp28xx_byte_read(0x1c) && 0x78 == tp28xx_byte_read(0x1d))
1828   2                      {
1829   3                        TP2825B_SetRX(PTZ_960P);
1830   3                        TP2825B_SetTX(PTZ_960P);                          
1831   3                      }
1832   2                      else
1833   2                      {
1834   3                        TP2825B_SetRX(PTZ_TVI);
1835   3                        TP2825B_SetTX(PTZ_TVI);
1836   3                      }                 
1837   2                      for(i = 0; i < 12; i++)
1838   2                      {
1839   3                              tp28xx_byte_write(0x55+i , PTZ_buf[i]); //line1&2
1840   3                              tp28xx_byte_write(0x61+i , PTZ_buf[i]); //line3&4
1841   3                      }       
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 32  

1842   2                      
1843   2              }
1844   1      
1845   1              StartTX();
1846   1      }
1847          //////////////////////////////////////////////////////////////////////////////
1848          //PTZ TX init
1849          //////////////////////////////////////////////////////////////////////////////
1850          void TP2825B_SetTX(BYTE index) 
1851          {
1852   1        unsigned char i;
1853   1        //unsigned char page_bak;
1854   1      
1855   1          CODE BYTE PTZ_dat[][10]=
1856   1          {
1857   1              {0x02,0x00,0x00,0x0b,0x0c,0x0d,0x0e,0x19,0x78,0x21}, //TVI 1080p
1858   1              {0x02,0x00,0x00,0x0b,0x0c,0x0d,0x0e,0x19,0x78,0x21}, //TVI 720p
1859   1              
1860   1              {0x02,0x00,0x00,0x0e,0x0f,0x10,0x11,0x24,0xf0,0x57}, //ACP2.0 for 2825B 148.5M
1861   1      
1862   1          
1863   1              {0x02,0x00,0x00,0x0e,0x0f,0x10,0x11,0x12,0x00,0x57}, //ACP2.0 for 2825B 74.25M
1864   1              {0x02,0x00,0x00,0x0f,0x10,0x00,0x00,0x12,0xf0,0x6f}, //960H for 2825B 74.25M
1865   1              {0x0a,0x1d,0x80,0x10,0x11,0x12,0x13,0x15,0xb8,0x9f}, //HDC 2825B 148.5M
1866   1              {0x0a,0x1d,0x80,0x10,0x11,0x12,0x13,0x0a,0x00,0x9f}, //HDC 2825B 74.25M
1867   1              {0x02,0x00,0x00,0x0e,0x0f,0x10,0x11,0x12,0x00,0x57}, //ACP2.0 for 2825B 74.25M
1868   1              {0x02,0x00,0x00,0x0d,0x0e,0x0f,0x10,0x0b,0x5a,0x17}, //BYD AHD960p30 94.5M
1869   1          };    
1870   1         CODE BYTE PTZ_reg[10]={0x6f,0x70,0x71,0xc2,0xc3,0xc4,0xc5,0xc6,0xc7,0xc8};
1871   1          
1872   1          if( PTZ_960P == index)  index = 0;  
1873   1          else if( PTZ_960P30_AHD == index) index = 8;  
1874   1        
1875   1            for(i = 0; i < 10; i++)
1876   1            {
1877   2              tp28xx_byte_write(PTZ_reg[i], PTZ_dat[index][i]);
1878   2            }
1879   1            for(i = 0; i < 24; i++)
1880   1            {
1881   2              tp28xx_byte_write(0x55+i, 0x00);
1882   2            }    
1883   1        
1884   1      }
1885          
1886          void Menu(void)
1887          {
1888   1        unsigned char i;
1889   1        CODE BYTE menu[][3]={
1890   1          {0x17,0x5f,0x00},
1891   1          {0xff,0x02,0x00},
1892   1          {0xfc,0x89,0x08},
1893   1          {0xfc,0x89,0x01}
1894   1        };
1895   1        
1896   1        i = std[0];
1897   1      
1898   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1899   1        if(STD_HDC == i) MonTX(menu[3][0], menu[3][1], menu[3][2], 0x00, 0x00);
1900   1      }
1901          void Left(void)
1902          {
1903   1        unsigned char i;
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 33  

1904   1        CODE BYTE menu[][3]={
1905   1          {0x09,0x00,0x00},
1906   1          {0xff,0x00,0x04},
1907   1          {0xfc,0x89,0x06}
1908   1        };
1909   1        
1910   1        i = std[0];
1911   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1912   1      }
1913          void Right(void)
1914          {
1915   1        unsigned char i;
1916   1        CODE BYTE menu[][3]={
1917   1          {0x08,0x00,0x00},
1918   1          {0xff,0x00,0x02},
1919   1          {0xfc,0x89,0x07}
1920   1        };
1921   1        
1922   1        i = std[0];
1923   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1924   1      }
1925          void Up(void)
1926          {
1927   1        unsigned char i;
1928   1        CODE BYTE menu[][3]={
1929   1          {0x06,0x00,0x00},
1930   1          {0xff,0x00,0x08},
1931   1          {0xfc,0x89,0x04}
1932   1        };
1933   1        
1934   1        i = std[0];
1935   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1936   1      }
1937          void Down(void)
1938          {
1939   1        unsigned char i;
1940   1        CODE BYTE menu[][3]={
1941   1          {0x07,0x00,0x00},
1942   1          {0xff,0x00,0x10},
1943   1          {0xfc,0x89,0x05}
1944   1        };
1945   1        
1946   1        i = std[0];
1947   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1948   1      }
1949          void Reset(void)
1950          {
1951   1        unsigned char i;
1952   1        CODE BYTE menu[][3]={
1953   1          {0x14,0x00,0x00},
1954   1          {0x00,0x00,0x10},
1955   1          {0xfc,0x89,0x00}
1956   1        };
1957   1        
1958   1        i = std[0];
1959   1        MonTX(menu[i][0], menu[i][1], menu[i][2], 0x00, 0x00);
1960   1      }
1961          
1962          void ReadUTC(void)
1963          {
1964   1            unsigned char tmp;
1965   1            if(VIDEO_LOCKED==state[0])
C51 COMPILER V9.60.7.0   TP2825B                                                           12/22/2023 18:00:43 PAGE 34  

1966   1            {     
1967   2              tmp = tp28xx_byte_read(0xB6);
1968   2                  if(0x10 & tmp)
1969   2              {
1970   3                //Printf("\r\nDATA1~4: %02x %02x  %02x %02x", (WORD)tp28xx_byte_read(0x8f),(WORD)tp28xx_byte_read(0x8
             -e),(WORD)tp28xx_byte_read(0x8d),(WORD)tp28xx_byte_read(0x8c));  
1971   3                Printf("\r\nDATA1~4: %02x %02x  %02x %02x", (WORD)tp28xx_byte_read(0x8c),(WORD)tp28xx_byte_read(0x8d)
             -,(WORD)tp28xx_byte_read(0x8e),(WORD)tp28xx_byte_read(0x8f));  
1972   3                tmp = tp28xx_byte_read(0xa7);
1973   3                //if(0x03==tmp) Printf("\r\nDATA5~8: %02x %02x  %02x %02x", (WORD)tp28xx_byte_read(0x95),(WORD)tp28xx
             -_byte_read(0x94),(WORD)tp28xx_byte_read(0x93),(WORD)tp28xx_byte_read(0x92));  
1974   3                if(0x03==tmp) Printf("\r\nDATA5~8: %02x %02x  %02x %02x", (WORD)tp28xx_byte_read(0x92),(WORD)tp28xx_b
             -yte_read(0x93),(WORD)tp28xx_byte_read(0x94),(WORD)tp28xx_byte_read(0x95));  
1975   3                tp28xx_byte_write(0xb6, 0x10); //clear 
1976   3              }
1977   2            }     
1978   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   5303    ----
   CONSTANT SIZE    =   2421    ----
   XDATA SIZE       =     26      32
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =      7    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
